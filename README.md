# BI-communications
## Проект построения BI-аналитики коммуникационной активности сотрудников организации: MTS VATS + MySQL + Power BI

<b>Цель проекта</b> - построение BI-аналитики коммуникационной активности сотрудников коммерческой организациии для:
- предупреждения спада активности по ключевым клиентам
- эффективного распределения клиентской базы среди сотрудников
- анализа структуры активности сотрудников во внутренней / внешней среде
- и др.

В рамках проекта разработан ряд модулей на языке программирования Python, способных осуществлять сбор, предварительную обработку и
сохранение информации из различных источников, таких как:
- web-сервисы организации
- виртуальная АТС от МТС (ВАТС)

в единую локальную базу данных - для последующего оперативного анализа на платформе MS Power BI https://powerbi.microsoft.com/ru-ru/

Репозиторий содержит следующие блоки программного кода:
- auth.py - ресурс для авторизации в различных сервисов / баз данных
- get_abonents_dict.py - модуль выгрузки списка абенентов виртуальной АТС (ВАТС) от МТС в локальную базу данных (см. SCHEMA_vats.txt).
- get_callHistory.py - модуль для "перегрузки" истории вызовов из ВАТС в локальную базу данных с заданной частотой.
- get_db_maxdatetime.py - вспомогательный модуль, возвращающий максимальную дату-время, которая хранится в истории вызовов SCHEMA "vats".
- get_clients_numbers.py - модуль, демонстрирующий работу с SOAP-сервисом, поставляющим данные из учетной ERP-системы, например, 1С. Различные версии 1С все-еще являются популярными поставщиками данных в организациях, в том числе через SOAP-сервисы, возвращающие  в ответ на запрос структурированный XML-файл. Несмотря на то, что структура выдачи в каждом отдельно взятом случае будет различной,  рассмотрим алгоритм работы с SOAP-сервисом, т.к. информации в открытых источниках по данной теме - не много.
- compilation_modules.py - инструкция по компиляции кода (при необходимости).
- test_call_history.py - тестирование работы функционала модулей выгрузки истории вызовов.

Результат работы над проектом - система интерактивных отчетов, например:

![PBI](https://gcits.com/wp-content/uploads/PowerBIDashboardPhoneCalls.png)
